{"version":3,"sources":["project.js"],"names":["require","e","t","n","r","s","o","u","a","i","f","Error","code","l","exports","call","length","MapCreater","module","cc","_RFpush","Pane","Class","extends","Component","properties","row","default","range","column","playerPosition","type","Vec2","wallsPosition","boxesPosition","targetsPosition","floorSprite","Prefab","wallSprite","boxSprite","targetSprite","victoryPanel","playerLeft","SpriteFrame","playerUp","playerRight","playerDown","map","visible","player","Node","pane","Size","moving","targetNumber","victoryPanelObject","onLoad","this","node","victory","find","removeFromParent","destroy","Math","floor","setContentSize","width","height","x","y","j","p","Floor","init","Player","Wall","Box","Target","forEach","rows","element","currentPosition","getPostion","instantiate","parent","position","bind","playerSprite","addComponent","Sprite","spriteFrame","tag","composeTag","console","log","update","dt","restart","director","loadScene","arr","isGround","index","undefined","nodeTopLeft","onUp","checkMove","UP","mulSelf","onDown","onLeft","RIGHT","onRight","frame","step","getComponent","nextPos","add","onMove","srcPos","dstPos","containPane","srcElement","dstElement","Invalid","srcTag","getChildByTag","action","sequence","moveTo","callFunc","getScene","opacity","Animation","play","runAction","_RFpop","MapPaneEnum","PressDownScale","pressedScale","transDuration","onTouchDown","event","stopAllActions","self","scaleDownAction","onTouchUp","scaleUpAction","initScale","scale","button","Button","scaleTo","on","VictoryPanel","stopPropagation"],"mappings":"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","file":"project.js","sourcesContent":["require=(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({\"MapCreater\":[function(require,module,exports){\ncc._RFpush(module, '280c3rsZJJKnZ9RqbALVwtK', 'MapCreater');\n// scripts/MapCreater.js\n\n'use strict';\n\nvar Pane = require('MapPaneEnum');\n\ncc.Class({\n    'extends': cc.Component,\n\n    properties: {\n        row: {\n            'default': 6,\n            range: [1, 6]\n        },\n        column: {\n            'default': 10,\n            range: [1, 10]\n        },\n\n        playerPosition: {\n            'default': null,\n            type: cc.Vec2\n        },\n        wallsPosition: {\n            'default': [],\n            type: cc.Vec2\n        },\n        boxesPosition: {\n            'default': [],\n            type: cc.Vec2\n        },\n        targetsPosition: {\n            'default': [],\n            type: cc.Vec2\n        },\n\n        floorSprite: {\n            'default': null,\n            type: cc.Prefab\n        },\n        wallSprite: {\n            'default': null,\n            type: cc.Prefab\n        },\n        boxSprite: {\n            'default': null,\n            type: cc.Prefab\n        },\n        targetSprite: {\n            'default': null,\n            type: cc.Prefab\n        },\n        victoryPanel: {\n            'default': null,\n            type: cc.Prefab\n        },\n\n        playerLeft: {\n            'default': null,\n            type: cc.SpriteFrame\n        },\n        playerUp: {\n            'default': null,\n            type: cc.SpriteFrame\n        },\n        playerRight: {\n            'default': null,\n            type: cc.SpriteFrame\n        },\n        playerDown: {\n            'default': null,\n            type: cc.SpriteFrame\n        },\n\n        // private\n        map: {\n            'default': null,\n            visible: false\n        },\n        player: {\n            'default': null,\n            type: cc.Node,\n            visible: false\n        },\n        pane: {\n            'default': null,\n            type: cc.Size,\n            visible: false\n        },\n        moving: {\n            'default': false,\n            visible: false\n        },\n        targetNumber: {\n            'default': 0,\n            visible: false\n        },\n        victoryPanelObject: {\n            'default': null,\n            type: cc.Node,\n            visible: false\n        }\n    },\n\n    // use this for initialization\n    onLoad: function onLoad() {\n        this.victoryPanelObject = this.node;\n        var victory = cc.find('Canvas/VictoryPanel');\n        if (victory) {\n            victory.removeFromParent(true);\n            victory.destroy();\n            victory = null;\n        }\n\n        this.targetNumber = 0;\n        this.map = [];\n        this.player = new cc.Node();\n        this.pane = new cc.Size(96, 96);\n\n        this.row = Math.floor(this.row);\n        this.column = Math.floor(this.column);\n        this.node.setContentSize(this.column * this.pane.width, this.row * this.pane.height);\n\n        this.playerPosition.x = Math.floor(this.playerPosition.x);\n        this.playerPosition.y = Math.floor(this.playerPosition.y);\n\n        // init map\n        for (var i = 0; i < this.column; ++i) {\n            this.map[i] = [];\n            for (var j = 0; j < this.row; ++j) {\n                this.map[i][j] = cc.p(Pane.Floor, -1);\n            }\n        }\n\n        this.init([this.playerPosition], Pane.Player);\n        this.init(this.wallsPosition, Pane.Wall);\n        this.init(this.boxesPosition, Pane.Box);\n        this.init(this.targetsPosition, Pane.Target, true);\n\n        // add sprite\n        this.map.forEach((function (rows, i) {\n            rows.forEach((function (element, j) {\n                var currentPosition = this.getPostion(i, j);\n\n                var node;\n                if (element.x === Pane.Floor) {\n                    node = cc.instantiate(this.floorSprite);\n                } else if (element.x === Pane.Target) {\n                    node = cc.instantiate(this.targetSprite);\n                }\n                if (node) {\n                    node.parent = this.node;\n                    node.position = currentPosition;\n                }\n            }).bind(this));\n        }).bind(this));\n\n        this.map.forEach((function (rows, i) {\n            rows.forEach((function (element, j) {\n                var currentPosition = this.getPostion(i, j);\n\n                var node;\n                if (element.y === Pane.Player) {\n                    var playerSprite = this.player.addComponent(cc.Sprite);\n                    playerSprite.spriteFrame = this.playerRight;\n                    node = this.player;\n                } else if (element.y === Pane.Wall) {\n                    node = cc.instantiate(this.wallSprite);\n                } else if (element.y === Pane.Box) {\n                    node = cc.instantiate(this.boxSprite);\n                }\n\n                if (node) {\n                    node.parent = this.node;\n                    node.position = currentPosition;\n                    node.tag = this.composeTag(cc.p(i, j));\n                    console.log(node.tag);\n                }\n            }).bind(this));\n        }).bind(this));\n    },\n\n    // called every frame\n    update: function update(dt) {},\n\n    restart: function restart() {\n        var result = cc.director.loadScene('helloworld');\n    },\n\n    init: function init(arr, code, isGround) {\n        var i = 0;\n        for (var index in arr) {\n            var x = Math.floor(arr[index].x);\n            var y = Math.floor(arr[index].y);\n            if (x < 0 || x >= this.column || y < 0 || y >= this.row) {\n                delete arr[index];\n                continue;\n            }\n\n            if (isGround) {\n                this.map[x][y] = cc.p(code, -1);\n            } else {\n                this.map[x][y].y = code;\n            }\n\n            if (code == Pane.Target) {\n                ++this.targetNumber;\n            }\n        }\n    },\n\n    getPostion: function getPostion(column, row) {\n        if (row === undefined) {\n            row = column.y;\n            column = column.x;\n        }\n        var nodeTopLeft = cc.p(-this.node.width / 2, this.node.height / 2);\n        return cc.p(nodeTopLeft.x + this.pane.width * (column + 0.5), nodeTopLeft.y - this.pane.height * (row + 0.5));\n    },\n\n    composeTag: function composeTag(position) {\n        var i = position.x;\n        var j = position.y;\n        return i * this.column + j;\n    },\n\n    onUp: function onUp() {\n        this.checkMove(this.playerLeft, cc.Vec2.UP.mulSelf(-1));\n    },\n\n    onDown: function onDown() {\n        this.checkMove(this.playerRight, cc.Vec2.UP);\n    },\n\n    onLeft: function onLeft() {\n        this.checkMove(this.playerLeft, cc.Vec2.RIGHT.mulSelf(-1));\n    },\n\n    onRight: function onRight() {\n        this.checkMove(this.playerRight, cc.Vec2.RIGHT);\n    },\n\n    checkMove: function checkMove(frame, step) {\n        if (this.moving) {\n            return;\n        }\n        this.player.getComponent(cc.Sprite).spriteFrame = frame;\n\n        var nextPos = this.playerPosition.add(step);\n        this.onMove(nextPos, nextPos.add(step));\n        if (this.onMove(this.playerPosition, nextPos)) {\n            this.moving = true;\n            this.playerPosition = nextPos;\n        }\n    },\n\n    onMove: function onMove(srcPos, dstPos) {\n        if (!this.containPane(srcPos) || !this.containPane(dstPos)) {\n            return false;\n        }\n\n        var srcElement = this.map[srcPos.x][srcPos.y];\n        var dstElement = this.map[dstPos.x][dstPos.y];\n        if (srcElement.y !== Pane.Player && srcElement.y !== Pane.Box) {\n            return false;\n        }\n\n        if (dstElement.y !== Pane.Invalid) {\n            return false;\n        }\n\n        console.log(srcPos + ' ' + dstPos);\n        var srcTag = this.composeTag(srcPos);\n        var node = this.node.getChildByTag(srcTag);\n        if (!node) {\n            return false;\n        }\n        var action = cc.sequence(cc.moveTo(0.5, this.getPostion(dstPos)), cc.callFunc((function () {\n            this.moving = false;\n        }).bind(this)));\n\n        node.tag = this.composeTag(dstPos);\n        if (srcElement.x === Pane.Target && srcElement.y === Pane.Box) {\n            ++this.targetNumber;\n        }\n        dstElement.y = srcElement.y;\n        srcElement.y = Pane.Invalid;\n        if (dstElement.x === Pane.Target && dstElement.y === Pane.Box) {\n            --this.targetNumber;\n            if (this.targetNumber === 0) {\n                var victory = cc.instantiate(this.victoryPanel);\n                victory.parent = cc.director.getScene();\n                victory.opacity = 0;\n                action = cc.sequence(action, cc.callFunc((function () {\n                    victory.getComponent(cc.Animation).play('fadeIn');\n                }).bind(this)));\n            }\n        }\n\n        node.runAction(action);\n        return true;\n    },\n\n    containPane: function containPane(pane) {\n        return pane.x >= 0 && pane.x < this.column && pane.y >= 0 && pane.y < this.row;\n    }\n});\n\ncc._RFpop();\n},{\"MapPaneEnum\":\"MapPaneEnum\"}],\"MapPaneEnum\":[function(require,module,exports){\ncc._RFpush(module, '0ac01Lj4uVPlYbW6mQjqo6B', 'MapPaneEnum');\n// scripts/MapPaneEnum.js\n\n\"use strict\";\n\nmodule.exports = {\n    Invalid: -1,\n    Player: 0,\n    Floor: 1,\n    Wall: 2,\n    Box: 3,\n    Target: 4\n};\n\ncc._RFpop();\n},{}],\"PressDownScale\":[function(require,module,exports){\ncc._RFpush(module, 'cf428ZWmAZC/YhaifgAcaCG', 'PressDownScale');\n// scripts/Common/PressDownScale.js\n\n'use strict';\n\ncc.Class({\n    'extends': cc.Component,\n\n    properties: {\n        pressedScale: 1,\n        transDuration: 0\n    },\n\n    // use this for initialization\n    onLoad: function onLoad() {\n        var self = this;\n        self.initScale = this.node.scale;\n        self.button = self.getComponent(cc.Button);\n        self.scaleDownAction = cc.scaleTo(self.transDuration, self.pressedScale);\n        self.scaleUpAction = cc.scaleTo(self.transDuration, self.initScale);\n        function onTouchDown(event) {\n            this.stopAllActions();\n            this.runAction(self.scaleDownAction);\n        }\n        function onTouchUp(event) {\n            this.stopAllActions();\n            this.runAction(self.scaleUpAction);\n        }\n        this.node.on('touchstart', onTouchDown, this.node);\n        this.node.on('touchend', onTouchUp, this.node);\n        this.node.on('touchcancel', onTouchUp, this.node);\n    }\n});\n\ncc._RFpop();\n},{}],\"VictoryPanel\":[function(require,module,exports){\ncc._RFpush(module, 'fa118V7biFBeoKgCUDt7Z8b', 'VictoryPanel');\n// scripts/VictoryPanel.js\n\n'use strict';\n\ncc.Class({\n    'extends': cc.Component,\n\n    properties: {\n        // foo: {\n        //    default: null,\n        //    url: cc.Texture2D,  // optional, default is typeof default\n        //    serializable: true, // optional, default is true\n        //    visible: true,      // optional, default is true\n        //    displayName: 'Foo', // optional\n        //    readonly: false,    // optional, default is false\n        // },\n        // ...\n    },\n\n    // use this for initialization\n    onLoad: function onLoad() {\n        this.node.on('touchstart', function (event) {\n            if (this.opacity > 0) {\n                event.stopPropagation();\n            }\n        });\n        this.node.on('touchmove', function (event) {\n            if (this.opacity > 0) {\n                event.stopPropagation();\n            }\n        });\n        this.node.on('touchend', function (event) {\n            if (this.opacity > 0) {\n                event.stopPropagation();\n            }\n        });\n        this.node.on('touchcancel', function (event) {\n            if (this.opacity > 0) {\n                event.stopPropagation();\n            }\n        });\n    }\n\n});\n// called every frame, uncomment this function to activate update callback\n// update: function (dt) {\n\n// },\n\ncc._RFpop();\n},{}]},{},[\"MapPaneEnum\",\"MapCreater\",\"PressDownScale\",\"VictoryPanel\"]);\n"],"sourceRoot":"/source/"}